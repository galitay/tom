<html>
    <head>
        <script>
            let token = localStorage.getItem('token');
            if (token) {
                window.location = "http://localhost:3002";
            }
            else {
                var clientId = "ddc9bc57-5764-4dea-b006-63e86db2a060";
                var redirectUrl = "http://localhost:3002/";
                var authServer = "https://login.microsoftonline.com/common/oauth2/v2.0/authorize?";
                var responseType = "token";
                var stateParam = Math.random() * new Date().getTime();
                document.cookie = "myEventsState=" + stateParam;
        
                var authUrl = authServer +
                    "response_type=" + encodeURI(responseType) +
                    "&client_id=" + encodeURI(clientId) +
                    "&scope=" + encodeURI("https://outlook.office.com/User.Read https://outlook.office.com/User.ReadBasic.All https://outlook.office.com/Calendars.Read https://outlook.office.com/Calendars.Read.Shared  https://outlook.office.com/Calendars.ReadWrite https://outlook.office.com/Calendars.ReadWrite.Shared") +
                    "&redirect_uri=" + redirectUrl +
                    "&state=" + stateParam;
                window.location = authUrl;
            }
        </script>
    </head>
    <body>
    </body>
</html>